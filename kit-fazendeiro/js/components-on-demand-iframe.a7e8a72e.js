"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[26998],{5539:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(22700);const o=e=>e&&(0,a.b)(e,"?")?"&":"?"},16831:(e,t,n)=>{n.d(t,{W:()=>a});const a=()=>{var e,t;null===(e=window)||void 0===e||null===(e=e.location)||void 0===e||null===(t=e.reload)||void 0===t||t.call(e)}},35122:(e,t,n)=>{n.d(t,{A:()=>a});const a="object"==typeof window?window:n.g},45752:(e,t,n)=>{n.d(t,{MA:()=>a});const a={BUSINESS_SHIPPING_HUB_EVENT_LOADED:"nav:cp:loaded",BUSINESS_SHIPPING_HUB_EVENT_REDIRECT:"nav:cp:redirect"}},61568:(e,t,n)=>{n.d(t,{A:()=>o});n(23792),n(18111),n(61701),n(62953);var a=n(5539);const o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Object.entries(t).map(e=>{let[t,n]=e;return`${t}=${n}`}).join("&");return`${e}${(0,a.A)(e)}${n}`}},65346:(e,t,n)=>{n.d(t,{m:()=>a});const a={MSG_LOADED:"vpp:on-demand-iframe:loaded",MSG_CLOSE:"vpp:on-demand-iframe:close",MSG_CLOSABLE:"vpp:on-demand-iframe:closable",MSG_SNACKBAR:"vpp:on-demand-iframe:snackbar",MSG_NAVIGATE:"vpp:on-demand-iframe:navigate",MSG_REDIRECT:"vpp:on-demand-iframe:redirect",MSG_ASK_SELLER:"vpp:on-demand-iframe:ask-seller",MSG_SCROLL_TO_ELEMENT:"vpp:on-demand-iframe:scroll-to-element",MSG_SEQUENCER:"vpp:on-demand-iframe:sequencer",MSG_REFRESH_PAGE:"vpp:on-demand-iframe:refresh-page"}},78397:(e,t,n)=>{n.r(t),n.d(t,{default:()=>$});var a=n(73620),o=n(89379),r=(n(74423),n(23792),n(62953),n(96540)),s=n(62929),l=n(3959),i=n(46942),d=n.n(i),c=n(81762),u=n(35122),E=n(800),_=n(99511),m=n(81821),f=n(65346),S=n(45752),A=n(76147),g=n(66146),p=n(66342),v=n(31018),b=n(33893),L=n(61568),C=n(5539),M=n(16831);const{MSG_LOADED:R,MSG_CLOSE:T,MSG_CLOSABLE:N,MSG_SNACKBAR:I,MSG_NAVIGATE:h,MSG_REDIRECT:D,MSG_ASK_SELLER:O,MSG_SCROLL_TO_ELEMENT:w,MSG_SEQUENCER:k}=f.m,{BUSINESS_SHIPPING_HUB_EVENT_REDIRECT:G,BUSINESS_SHIPPING_HUB_EVENT_LOADED:y}=S.MA,U=(0,o.A)((0,o.A)({},f.m),S.MA),B="on-demand-iframe",$=e=>{var t;let{id:n="",src:i,isRedirectFlow:f=!1,title:S="",iframeTitle:$="iframe",show:V=!1,renderMode:F=v.M8.CONTAINER,noScrolling:H=!1,fallbackConfig:P=null,statsdConfig:W=null,isDismissible:q=!0,showSnackbar:x=null,onDemandIframeClose:K,onDemandIframeUpdate:j,updateComponentsBottomSheet:Q=null,onCloseVariations:Y=null,onCreateQuestionFromAi:z=null,showVariationsError:J=null,sequencerTrack:X=null,customNamespace:Z="",noCloseButton:ee=!1,onDemandSequencerUpdate:te=null,isFromMSG:ne=!1,onMessage:ae}=e;const oe=(0,r.useRef)(null),re=(0,r.useRef)(null),se=(0,r.useRef)(null),le=(0,r.useRef)(!1),ie=(0,r.useRef)(!1),[de,ce]=(0,r.useState)(!1),[ue,Ee]=(0,r.useState)(null),[_e,me]=(0,r.useState)(!1),[fe,Se]=(0,r.useState)(null),{fallbackUrl:Ae,fallbackMessage:ge,timeoutInitialLoad:pe,timeoutWebviewMessage:ve}=P||{},{deviceType:be}=(0,r.useContext)(b.Ay),Le=(0,L.A)(i,{parent_origin:null===u.A||void 0===u.A||null===(t=u.A.location)||void 0===t?void 0:t.origin}),Ce=d()(B,{[`${B}--${be}`]:be,[`${B}--${be}__sidebar`]:"mobile"!==be&&F!==v.M8.CENTERED,[`${B}--${be}__centered`]:"mobile"!==be&&F===v.M8.CENTERED,[`${B}--${be}__bottom-sheet`]:"mobile"===be&&F===v.M8.CONTAINER,[`${B}--${be}__fullscreen`]:"mobile"===be&&(F===v.M8.FULLSCREEN||F===v.M8.CENTERED),[`${B}--no__close__button`]:ee,[`${B}--${Z}`]:Z}),Me=e=>{let{message:t,additionalTags:n={},additionalInfo:a,shouldLogMessage:r}=e;(0,p.b)({key:A.O.SHOW_SNACKBAR,additionalTags:(0,o.A)({snackbar_type:"error"},n),additionalInfo:a,shouldLogMessage:r,statsdConfig:W}),x&&x({message:t,type:"error"})},Re=e=>{let{url:t,target:n,newRenderMode:a}=e;if(t&&(0,m.A)({target:t,currentLocation:window.location})){if("parent"===n&&(window.location.href=t),"modal"===n&&j){Ee(null);const e={src:`${t}${(0,C.A)(t)}navhash=${Date.now().toString().slice(-5)}`,isRedirectFlow:!0,isDismissible:!0};a&&(e.renderMode=a),X&&(0,E.sx)((0,v.LU)(X,v.Y8.NAVIGATE_LOADING)),(0,p.b)({key:A.O.WEBVIEW_REDIRECT,statsdConfig:W}),j(e)}}else Me({additionalTags:{reason:g.n7.INVALID_REDIRECT_URL},additionalInfo:{url:t,target:n},shouldLogMessage:!0})},Te=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{requestPageRefresh:t=!1}=e;Y&&Y(),K&&K(),ue&&((0,E.sx)(ue),Ee(null)),Se&&Se(null),me&&t&&me(!0)},Ne=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{trackData:t=null,refreshCartIcon:n=!1,shouldUpdateComponents:a=!1,disableClose:r=!1,titleModal:s=null}=e;clearTimeout(oe.current),Se(s),ce(!0),ie.current=!0,r&&j({isDismissible:!1}),t&&Ee({melidata_event:(0,o.A)({},t)}),X&&(0,E.sx)((0,v.LU)(X,re.current?v.Y8.NAVIGATE_LOADED:v.Y8.LOADED));const{FLOW_END:l,FLOW_END_FROM_MSG:i}=A.O;var d;(0,p.b)({key:le.current?i:l,additionalTags:{end_case:re.current?`${se.current}_redirect`:se.current},statsdConfig:W}),n&&(null===(d=u.A.freya)||void 0===d||d.emit("cart:refresh")),a&&Q&&Q()},Ie=e=>{if(V){var t,n;const a=Object.values(U).includes(null==e||null===(t=e.data)||void 0===t?void 0:t.type);if(null!=e&&null!==(n=e.data)&&void 0!==n&&n.type&&a)switch(e.data.type){case k:!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,p.b)({key:A.O.SEQUENCER_UPDATE_FROM_MSG,statsdConfig:W}),null==te||te({data:e,fallbackConfig:P,statsdConfig:W})}(e.data.data);break;case y:case R:Ne(e.data.data);break;case T:Te();break;case N:j({isDismissible:e.data.enabled});break;case I:!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{snackbar:t,close:n}=e;if(t&&x){const{message:e,type:a,delay:o,called_from:r,action:s}=t;n&&Te(),s&&(s.onClick=()=>Re({url:s.redirectUrl,target:"parent"})),x({message:e,type:a,delay:o,called_from:r,action:s})}}(e.data);break;case h:!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{url:t,render_mode:n}=e;Re({url:t,target:"modal",newRenderMode:n})}(e.data);break;case D:Re({url:e.data.url,target:"parent"});break;case O:!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{itemId:t,question:n,snackbar_message:a,track:o}=e;n&&t&&z&&(Te(),z({itemId:t,text:n,snackbar_message:a,suggestionTrack:o,source:"webview"}))}(e.data);break;case w:!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{selector:t,shouldRaiseErrors:n}=e;if(t){const e=document.querySelector(t);Te(),e.scrollIntoView({behavior:"smooth",block:"start"}),n&&J()}}(e.data);break;case G:ce(!1),me(!0)}}},he=e=>{ie.current||(X&&(0,E.sx)((0,v.LU)(X)),Ae&&(0,m.A)({target:Ae,currentLocation:window.location})?((0,p.b)({key:A.O.REDIRECT_TO_FALLBACK,additionalTags:{reason:e,flow_redirect:Boolean(re.current)},statsdConfig:W}),window.location.href=Ae):(Me({message:null==ge?void 0:ge.message,additionalTags:{reason:e,flow_redirect:Boolean(re.current)}}),Te()))};return(0,r.useEffect)(()=>{i&&P&&(ie.current=!1,oe.current=setTimeout(()=>{he(g.n7.TIMEOUT_INITIAL_LOAD)},pe||1e4))},[i]),(0,r.useEffect)(()=>{var e,t;(V||(ce(!1),ie.current=!1),Y&&V)&&(null===(e=document.querySelector(".ui-pdp-backdrop-modal"))||void 0===e||e.setAttribute("style","height:0px"),null===(t=document.querySelectorAll(".andes-modal__overlay")[0])||void 0===t||t.setAttribute("style","height:0px"));return u.A.addEventListener("message",Ie),()=>{u.A.removeEventListener("message",Ie),clearTimeout(oe.current)}},[V]),(0,r.useEffect)(()=>{se.current=F===v.M8.CONTAINER?"bottom_sheet":"landing",re.current=Boolean(f),le.current=Boolean(ne)},[F,f,ne]),(0,r.useEffect)(()=>{de&&_e&&(me(!1),(0,M.W)())},[de,_e]),(0,a.A)(s.a,{open:V,id:n,onClose:Te,type:F===v.M8.FULLSCREEN?"full":"mobile"===be?"card":"large",title:fe?(0,a.A)(l.s6,{},void 0,fe):S||" ",className:Ce,closable:de&&q},void 0,(0,a.A)(_.A,{title:$,"data-testid":"iframe-element",src:Le,showSpinner:!0,scrolling:H?"no":"auto",forceSpinner:!de||_e,spinnerClassname:"center-spinner",onLoad:()=>{clearTimeout(oe.current),P&&(oe.current=setTimeout(()=>{he(g.n7.TIMEOUT_WEBVIEW_MESSAGE)},ve||5e3))},onMessage:(()=>{if("function"==typeof ae)return ae;const{FULLSCREEN:e,CONTAINER:t,CENTERED:n}=v.M8,a={typeName:"vpp:on-demand-iframe:resize",height:"height",containerSelector:".on-demand-iframe",headerSelector:".andes-modal__header",width:void 0,deviceType:be};switch(F){case n:a.width="width";break;case t:"mobile"===be&&(a.containerSelector=".ui-pdp-iframe")}return(0,c.A)(...Object.values(a))})()}))}},78579:(e,t,n)=>{n.d(t,{A:()=>a});const a=n(24584).v},81762:(e,t,n)=>{n.d(t,{A:()=>a});const a=n(20551).VW},81821:(e,t,n)=>{n.d(t,{A:()=>a});const a=n(20551).Dp},99511:(e,t,n)=>{n.d(t,{A:()=>a});const a=n(78579).A}}]);
//# sourceMappingURL=components-on-demand-iframe.a7e8a72e.js.map